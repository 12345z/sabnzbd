<script type="text/javascript" src="../../static/MochiKit/MochiKit.js"></script>
<script type="text/javascript">
MochiKit.DOM.addLoadEvent(location = "../../#config-rss");
</script>
<a href="${helpuri}Configure+RSS+V2" id="help" target="_blank">Help</a><h2>$T('configRSS')</h2>

<div class="EntryBlock" id="add_rss_feed">
<fieldset class="EntryFieldSet">
<legend>$T('newFeedURI')</legend>

    <input type="text" size="10" name="feed" value="$feed"/>
    <input type="text" size="80" name="uri" value=""/>
    <input type="submit" value="$T('button-add')" onclick="javascript:submitconfig('config/rss/add_rss_feed', '','add_rss_feed', '1')"   />
</fieldset>
</div>

<p>$T('explain-RSS')</p>
<!--#for $feed in $rss#-->

<fieldset class="EntryFieldSet">
    <legend <!--#if $rss[$feed]['enable'] then 'class="feedEnabled"' else 'class="feedDisabled"'#-->><input type="checkbox" onclick="javascript:submitconfig('config/rss/toggle_rss_feed', '','update_$feed','1' )"  name="enable" <!--#if $rss[$feed]['enable'] then "CHECKED" else "" #-->/>
    $T('feed') $feed</legend>
    <hr />
    <div class="EntryBlock" id="update_$feed">

            <input type="text" size="92" name="uri" value="$rss[$feed]['uri']"/>
            <input type="submit" onclick="javascript:if (confirm('$T('confirm').replace("'","`") ')) {submitconfig('config/rss/del_rss_feed', '','update_$feed','1' )}" value="$T('button-delFeed')"/>
            <input type="submit" onClick="javascript:location='./config/rss/test_rss_feed?feed=$feed&session=$session'" value="$T('button-preFeed')"/>
            <input type="submit" onClick="javascript:location='./config/rss/download_rss_feed?feed=$feed&session=$session'" value="$T('button-forceFeed')"/>
            <br/><br/>

            <!--#if $rss[$feed]['pick_cat']#-->
                <select name="cat">
                    <optgroup label="$T('category')">
                        <!--#for $ct in $cat_list#-->
                            <option value="$ct" <!--#if $ct == $rss[$feed]['cat'] then "selected" else ""#-->>$Tspec($ct)</option>
                        <!--#end for#-->
                    </optgroup>
                </select>
            <!--#end if#-->
            <select name="pp">
                <optgroup label="$T('pp')">
                    <option value="" <!--#if $rss[$feed]['pp'] == "" then 'selected' else ''#-->>$T('default')</option>
                    <option value="0" <!--#if $rss[$feed]['pp'] == "0" then 'selected' else ''#-->>$T('none')</option>
                    <option value="1" <!--#if $rss[$feed]['pp'] == "1" then 'selected' else ''#-->>$T('pp-repair')</option>
                    <option value="2" <!--#if $rss[$feed]['pp'] == "2" then 'selected' else ''#-->>$T('pp-unpack')</option>
                    <option value="3" <!--#if $rss[$feed]['pp'] == "3" then 'selected' else ''#-->>$T('pp-delete')</option>
                </optgroup>
            </select>
            <!--#if $rss[$feed]['pick_script']#-->
                <select name="script">
                        <optgroup label="$T('script')">
                        <!--#for $sc in $script_list#-->
                            <option value="$sc" <!--#if $sc == $rss[$feed]['script'] then "selected" else ""#-->>$Tspec($sc)</option>
                        <!--#end for#-->
                    </optgroup>
                </select>
            <!--#end if#-->
            <select name="priority">
            <optgroup label="$T('priority')">
                    <option value="-100" <!--#if $rss[$feed]['priority'] == -100 then 'selected' else ''#-->>$T('default')</option>
                    <option value="2" <!--#if $rss[$feed]['priority'] == 2 then 'selected' else ''#-->>$T('pr-force')</option>
                    <option value="1" <!--#if $rss[$feed]['priority'] == 1 then 'selected' else ''#-->>$T('pr-high')</option>
                    <option value="0" <!--#if $rss[$feed]['priority'] == 0 then 'selected' else ''#-->>$T('pr-normal')</option>
                    <option value="-1" <!--#if $rss[$feed]['priority'] == -1 then 'selected' else ''#-->>$T('pr-low')</option>>
                </optgroup>
            </select>
            <input type="hidden" name="feed" value="$feed"/>
            <!--<input type="checkbox" onclick="javascript:submitconfig('config/rss/toggle_rss_feed', '','update_$feed','1' )"  name="enable" <!--#if $rss[$feed]['enable'] then "CHECKED" else "" #-->/>Scheduled -->
            <input type="submit" value="$T('button-save')" onclick="javascript:submitconfig('config/rss/upd_rss_feed', this,'update_$feed','1' )" />

        </fieldset>

    </div>
    <br/>

    <table id="rssTable">
    <thead>
        <tr>
            <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
            <th>$T('rss-order')</th>
            <th>$T('rss-type')</th>
            <th>$T('rss-filter')</th>
            <!--#if $rss[$feed]['pick_cat']#--> <th>$T('category')</th> <!--#end if#-->
            <th>Mode</th>
            <!--#if $rss[$feed]['pick_script']#--> <th>$T('script')</th> <!--#end if#-->
            <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
        </tr>
    </thead>
    <tbody>
    <tr id="$feed+new_filter">
        <td></td>
        <td></td>
        <td>
            <select name="filter_type">
                <option value="A" selected /> $T('rss-accept')</option>
                <option value="M" /> $T('rss-must')</option>
                <option value="R" /> $T('rss-reject')</option>
                <option value="C" /> $T('rss-mustcat')</option>
            </select>
        </td>
        <td><input type="text" size="40" class="filter_text fill-td" name="filter_text" value=""></td>
        <!--#if $rss[$feed]['pick_cat']#-->
          <td>
            <select name="cat">
            <!--#for $ct in $cat_list#-->
                <option value="$ct" <!--#if $ct == $rss[$feed]['cat'] then "selected" else ""#-->>$Tspec($ct)</option>
            <!--#end for#-->
            </select>
          </td>
        <!--#end if#-->
        <td>
          <select name="pp">
              <option value="" <!--#if $rss[$feed]['pp'] == "0" then 'selected' else ''#-->>$T('default')</option>
              <option value="0" <!--#if $rss[$feed]['pp'] == "0" then 'selected' else ''#-->>$T('none')</option>
              <option value="1" <!--#if $rss[$feed]['pp'] == "1" then 'selected' else ''#-->>$T('pp-repair')</option>
              <option value="2" <!--#if $rss[$feed]['pp'] == "2" then 'selected' else ''#-->>$T('pp-unpack')</option>
              <option value="3" <!--#if $rss[$feed]['pp'] == "3" then 'selected' else ''#-->>$T('pp-delete')</option>
          </select>
        </td>
        <!--#if $rss[$feed]['pick_script']#-->
          <td>
            <select name="script">
            <!--#for $sc in $script_list#-->
                <option value="$sc" <!--#if $sc == $rss[$feed]['script'] then "selected" else ""#-->>$Tspec($sc)</option>
            <!--#end for#-->
            </select>
          </td>
        <!--#end if#-->
        <td>
        <input type="hidden" value="$rss[$feed]['filtercount']" name="index">
        <input type="hidden" value="$feed" name="feed">
        <input type="submit" value="$T('button-save')"  onclick="javascript:submitconfig('config/rss/upd_rss_filter', this,'$feed+new_filter','1' )">
        </td>
    </tr>



    <!--#set $fnum = 0#-->


    <!--#for $filter in $rss[$feed].filters#-->
    <tr class="odd" id="$feed+$fnum">
        <td>
            <input type="submit" value="$T('rss-delFilter')" onclick="javascript:lr('config/rss/del_rss_filter','index=$fnum&feed=$feed')" />
        </td>

        <td>
			<select onChange="javascript:changequeuedetails('config/rss/'+this.options[this.selectedIndex].value);">
			<!--#for $i in xrange($rss[$feed]['filtercount'])#-->
				<option value="pos_rss_filter?feed=$feed&current=$fnum&new=$i" <!--#if int($i) == int($fnum) then "selected" else ""#-->>$i</option>
			<!--#end for#-->
			</select>
        </td>
        <td>
			<select name="filter_type">
				<option value="A" <!--#if $filter[3] == "A" then "selected" else ""#--> /> $T('rss-accept')</option>
				<option value="M" <!--#if $filter[3] == "M" then "selected" else ""#--> /> $T('rss-must')</option>
				<option value="R" <!--#if $filter[3] == "R" then "selected" else ""#--> /> $T('rss-reject')</option>
				<option value="C" <!--#if $filter[3] == "C" then "selected" else ""#--> /> $T('rss-mustcat')</option>
			</select>
        </td>
        <td>
		<input type="text" size="40" class="filter_text fill-td" name="filter_text" value="$filter[4]"/></td>
        <!--#if $rss[$feed]['pick_cat']#-->
		<td>
			<select name="cat">
			<!--#for $ct in $cat_list#-->
				<option value="$ct" <!--#if $ct == $filter[0] then "selected" else ""#-->>$Tspec($ct)</option>
			<!--#end for#-->
			</select>
		</td>
        <!--#end if#-->

            <td>
                <select name="pp">
                    <option value="" <!--#if $filter[1] == "0" then 'selected' else ''#-->>$T('default')</option>
                    <option value="0" <!--#if $filter[1] == "0" then 'selected' else ''#-->>$T('none')</option>
                    <option value="1" <!--#if $filter[1] == "1" then 'selected' else ''#-->>$T('pp-repair')</option>
                    <option value="2" <!--#if $filter[1] == "2" then 'selected' else ''#-->>$T('pp-unpack')</option>
                    <option value="3" <!--#if $filter[1] == "3" then 'selected' else ''#-->>$T('pp-delete')</option>
                </select>
            </td>
        <!--#if $rss[$feed]['pick_script']#-->
            <td>
            <select name="script">
            <!--#for $sc in $script_list#-->
                <option value="$sc" <!--#if $sc == $filter[2] then "selected" else ""#-->>$Tspec($sc)</option>
            <!--#end for#-->
            </select>
          </td>
        <!--#end if#-->
        <td>
        <input type="hidden" name="index" value="$fnum"/>
        <input type="hidden" name="feed" value="$feed"/>
        <input type="submit" value="$T('button-save')" onclick="javascript:submitconfig('config/rss/upd_rss_filter', this,'$feed+$fnum','1' )"/>
        </td>

    </tr>
        <!--#set $fnum = $fnum+1#-->
    <!--#end for#-->
</tbody>
    </table>
    </fieldset>
<br /><br /><br />
<!--#end for#-->
