<!--#set global $topmenu="config"#-->
<!--#set global $statpath="../.."#-->
<!--#set global $helpsubject="Configure+Sorting"#-->
<!--#include $webdir + "/inc_top.tmpl"#-->

<!--#set global $submenu="sorting"#-->
<!--#include $webdir + "/inc_cmenu.tmpl"#-->

<script type="text/javascript">
    function tvAdd(val){
        var tv = document.getElementById('tvfoldername'); 
        tv.value = tv.value + val;
        previewtv();
    }
    function tvSet(val){
        var tv = document.getElementById('tvfoldername'); 
        tv.value = val;
        previewtv();
    }
    function tvClear(){
        var tv = document.getElementById('tvfoldername'); 
        tv.value = '';
        previewtv();
    }
    function previewtv(){
        var input = document.getElementById('tvfoldername').value;
        var slash = "\\";
        input.toLowerCase()
        input = input.replace(/%ext/g,'avi');
        input = input.replace(/%sn/g,'Show Name');
        input = input.replace(/%s.n/g,'Show.Name');
        input = input.replace(/%s_n/g,'Show_Name');
        input = input.replace(/%0s/g,'01');
        input = input.replace(/%s/g,'1');
        input = input.replace(/%en/g,'Episode Name');
        input = input.replace(/%e\.n/g,'Episode.Name');
        input = input.replace(/%e\_n/g,'Episode_Name');
        input = input.replace(/%0e/g,'05');
        input = input.replace(/%e/g,'5');
        var com = document.getElementById('complete_dir').value;
        if (com.search("/") > 0)
        {
            slash = "/";
            input = input.replace("\\","/", "g");
        } else {
            input = input.replace("/","\\", "g");
        }
        len = com.length
        if (com.substring(len-1, len) == slash)
        {
            com = com.substring(0, len-1)
        }
        var outbox = document.getElementById('previewtv').innerHTML = com+slash+input;
    }
    
    function movieAdd(val){
        var tv = document.getElementById('moviefoldername'); 
        tv.value = tv.value + val;
        previewmovie();
    }
    function movieSet(val, val2){
        var tv = document.getElementById('moviefoldername'); 
        tv.value = val;
        var tv2 = document.getElementById('movieextra'); 
        tv2.value = val2;
        previewmovie();
    }
    function movieClear(){
        var tv = document.getElementById('moviefoldername'); 
        tv.value = '';
        previewmovie();
    }
    function movieClearExtra(){
        var tv = document.getElementById('movieextra'); 
        tv.value = '';
        previewmovie();
    }
    function movieExtraFolder(value)
    {
       document.getElementById('movie_extra_folder').checked = value;
    }
    function previewmovie()
    {
        var input = document.getElementById('moviefoldername').value;
        var input2 = document.getElementById('movieextra').value;
        extra = input2.replace(/%1/g,'1');
        var slash = "\\";
        ext = extra + '.avi'
        input = input.replace(/.%ext/g,ext);
        input = input.replace(/%ext/g,'avi');
        input = input.replace(/%title/g,'Movie Name');
        input = input.replace(/%.title/g,'Movie.Name');
        input = input.replace(/%_title/g,'Movie_Name');
        input = input.replace(/%y/g,'2000');
        input = input.replace(/%decade/g,'00');
        
        var regex = /\{([^\{]*)\}/g;
        var str = input;
        var result;
        while ((result = regex.exec(str)) != null)
        {
          var lower = result[0].toLowerCase();
          input = input.replace(result[0],lower);
        }
        input = input.replace(/{/g,'');
        input = input.replace(/}/g,'');
        var com = document.getElementById('complete_dir').value;
        if (com.search("/") > 0)
        {
            slash = "/";
            input = input.replace("\\","/", "g");
        } else {
            input = input.replace("/","\\", "g");
        }
        len = com.length
        if (com.substring(len-1, len) == slash)
        {
            com = com.substring(0, len-1)
        }
        var outbox = document.getElementById('previewmovie').innerHTML = com+slash+input;
    }
    function dateSet(val){
        var tv = document.getElementById('datefoldername'); 
        tv.value = val;
        previewdate();
    }
    function dateClear(){
        var tv = document.getElementById('datefoldername'); 
        tv.value = '';
        previewdate();
    }
    function previewdate(){
        var input = document.getElementById('datefoldername').value;
        var slash = "\\";
        input.toLowerCase()
        input = input.replace(/%ext/g,'avi');
        input = input.replace(/%t/g,'Show Name');
        input = input.replace(/%.t/g,'Show.Name');
        input = input.replace(/%_t/g,'Show_Name');
        input = input.replace(/%decade/g,'00');
        input = input.replace(/%desc/g,'Episode Name');
        input = input.replace(/%\.desc/g,'Episode.Name');
        input = input.replace(/%\_desc/g,'Episode_Name');
        input = input.replace(/%0d/g,'02');
        input = input.replace(/%d/g,'2');
        input = input.replace(/%0m/g,'01');
        input = input.replace(/%m/g,'1');
        input = input.replace(/%y/g,'2009');
        var com = document.getElementById('complete_dir').value;
        if (com.search("/") > 0)
        {
            slash = "/";
            input = input.replace("\\","/", "g");
        } else {
            input = input.replace("/","\\", "g");
        }
        len = com.length
        if (com.substring(len-1, len) == slash)
        {
            com = com.substring(0, len-1)
        }
        var outbox = document.getElementById('previewdate').innerHTML = com+slash+input;
    }
    function showDiv(id)
    {
        disp = (document.getElementById(id).style.display == "block") ? "none" : "block";
        document.getElementById(id).style.display = disp;
    }
</script>

<h2>Sorting configuration</h2>

<form action="saveSorting" method="post">
<div class="EntryBlock">
  <fieldset class="EntryFieldSet">

<legend>Series Sorting</legend>

    <input class="radio" type="checkbox" name="enable_tv_sorting" value="1" <!--#if $enable_tv_sorting > 0 then "checked=1" else ""#--> /> <strong>Enable TV Sorting</strong><br class="clear" />

    <a href="#toggle" onclick="javascript:showDiv('Keytable')">Toggle key</a>
     <div id="Keytable">
        <div class="row">
                <span class="heading1">Meaning</span>
                <span class="heading2">Pattern</span>
                <span class="heading3">Result</span>
        </div>
        <div class="row">
            <span class="tripleheight">Show Name</span>
            <span class="pattern">%sn</span>
            <span class="result">Show Name</span>
        <br />
            <span class="pattern">%s.n</span>
            <span class="result">Show.Name</span>
        <br />
            <span class="pattern">%s_n</span>
            <span class="result">Show_Name</span>
        </div>
        <div class="row">
            <span class="doubleheight">Season Number</span>
            <span class="pattern">%s</span>
            <span class="result">1</span>
        <br />
            <span class="pattern">%0s</span>
            <span class="result">01</span>
        </div>
        <div class="row">
            <span class="doubleheight">Episode Number</span>
            <span class="pattern">%e</span>
            <span class="result">5</span>
        <br />
            <span class="pattern">%0e</span>
            <span class="result">05</span>
        </div>
        <div class="row">
            <span class="tripleheight">Episode Name</span>
            <span class="pattern">%en</span>
            <span class="result">Episode Name</span>
        <br />
            <span class="pattern">%e.n</span>
            <span class="result">Episode.Name</span>
        <br />
            <span class="pattern">%e_n</span>
            <span class="result">Episode_Name</span>
        </div>
        <div class="row">
            <span class="normalheight">File Extension</span>
            <span class="pattern">%ext</span>
            <span class="result">avi</span>
        </div>
        <div class="row">
            <span class="normalheight">Lower Case</span>
            <span class="pattern">{TEXT}</span>
            <span class="result">text</span>
        </div>
        <!--
        <span class="">Original Filename</span>
        <span class="">%fn</span>
        <span class="">Episode Name</span>
        <br />-->
    </div><br class="clear" />
    <strong>Sort String:</strong><br class="clear" />
    <input type="text" style="width:400px" size="80" id="tvfoldername" name="tv_sort_string" value="$tv_sort_string" onkeyup="javascript:previewtv()"><input type="button" style="width:100px;" onclick="tvClear()" value="Clear"/><br class="clear" />
    <strong>Presets:</strong><br class="clear" />
    <input type="button" onclick="tvSet('%sn/Season %s/%sn - %sx%0e - %en.%ext')" value="1x05 Season Folder"/>
    <input type="button" onclick="tvSet('%sn/Season %s/%sn - S%0sE%0e - %en.%ext')" value="S01E05 Season Folder"/>
    <input type="button" onclick="tvSet('%sn/%sx%0e - %en/%sn - %sx%0e - %en.%ext')" value="1x05 Episode Folder"/>
    <input type="button" onclick="tvSet('%sn/S%0sE%0e - %en/%sn - S%0sE%0e - %en.%ext')" value="S01E05 Episode Folder"/><br class="clear" />
    <br class="clear" />
    Example: <span id="previewtv"></span>
    <br class="clear" /><br class="clear" />
  </fieldset>
<br />
  <fieldset class="EntryFieldSet">
<legend>Generic Sorting</legend>
    <input id="complete_dir" type="hidden" value="$complete_dir" />
    <input class="radio" type="checkbox" name="enable_movie_sorting" value="1" <!--#if $enable_movie_sorting > 0 then "checked=1" else ""#--> /> <strong>Enable Movie Sorting</strong>
    <br class="clear" /><br class="clear" />
    <input class="radio" type="checkbox" name="movie_extra_folder" value="1" <!--#if $movie_extra_folder > 0 then "checked=1" else ""#--> /> <strong>Keep loose downloads in extra folders</strong>
    <br class="clear" /><br class="clear" />
    <strong>Affected Categories:</strong>
    <br class="clear" />
    <select name="movie_cat" multiple="multiple" size=4 class="multiple_cats">
        <!--#for $ct in $cat_list#-->
            <!--#if $ct != 'Default'#-->
                <option value="$ct" <!--#if $ct in $movie_categories then 'selected' else ''#--> >$ct</option>
            <!--#end if#-->
        <!--#end for#-->
    </select>

    <br class="clear" /><br class="clear" />
    <a href="#toggle" onclick="javascript:showDiv('Keytable2')">Toggle key</a>
     <div id="Keytable2">
        <div class="row">
                <span class="heading1">Meaning</span>
                <span class="heading2">Pattern</span>
                <span class="heading3">Result</span>
        </div>
        <div class="row">
            <span class="tripleheight">Title</span>
            <span class="pattern">%title</span>
            <span class="result">Movie Name</span>
        <br />
            <span class="pattern">%.title</span>
            <span class="result">Movie.Name</span>
        <br />
            <span class="pattern">%_title</span>
            <span class="result">Movie_Name</span>
        </div>
        <div class="row">
            <span class="doubleheight">Year</span>
            <span class="pattern">%y</span>
            <span class="result">2000</span>
        </div>
        <div class="row">
            <span class="doubleheight">Extension</span>
            <span class="pattern">%ext</span>
            <span class="result">avi</span>
        </div>
        <div class="row">
            <span class="doubleheight">Part Number</span>
            <span class="pattern">%1</span>
            <span class="result">1</span>
        </div>
        <div class="row">
            <span class="normalheight">Decade</span>
            <span class="pattern">%decade</span>
            <span class="result">00</span>
        </div>
        <div class="row">
            <span class="normalheight">Lower Case</span>
            <span class="pattern">{TEXT}</span>
            <span class="result">text</span>
        </div>
    </div><br class="clear" /><br class="clear" />
    <strong>Sort String:</strong><br class="clear" />
    <input type="text" style="width:400px" size="80" id="moviefoldername" name="movie_sort_string" value="$movie_sort_string" onkeyup="javascript:previewmovie()"><input type="button" onclick="movieClear()" style="width:100px;" value="Clear"/><br class="clear" />
    <strong>Multi-part label:</strong><br class="clear" />
    <input type="text" style="width:400px" size="80" id="movieextra" name="movie_sort_extra" value="$movie_sort_extra" onkeyup="javascript:previewmovie()"><input type="button" onclick="movieClearExtra()" style="width:100px;" value="Clear"/><br class="clear" />
    <strong>Presets:</strong><br class="clear" />
    <input type="button" onclick="movieSet('%title (%y)/%title (%y).%ext',' CD%1');movieExtraFolder(false)" value="In folders"/>
    <input type="button" onclick="movieSet('%title (%y).%ext',' CD%1');movieExtraFolder(true)" value="No folders"/><br class="clear" />
    <br class="clear" />
    Example: <span id="previewmovie"></span>
    <br class="clear" /><br class="clear" />
  </fieldset>
<br />
<fieldset class="EntryFieldSet">
<legend>Date Sorting</legend>

    <input class="radio" type="checkbox" name="enable_date_sorting" value="1" <!--#if $enable_date_sorting > 0 then "checked=1" else ""#--> /> <strong>Enable Date Sorting</strong><br class="clear" />
    <br class="clear" />
    <strong>Affected Categories:</strong>
    <br class="clear" />
    <select name="date_cat" multiple="multiple" size=4 class="multiple_cats">
        <!--#for $ct in $cat_list#-->
            <!--#if $ct != 'Default'#-->
                <option value="$ct" <!--#if $ct in $date_categories then 'selected' else ''#--> >$ct</option>
            <!--#end if#-->
        <!--#end for#-->
    </select>
    <br class="clear" /><br class="clear" />
    <a href="#toggle" onclick="javascript:showDiv('Keytable3')">Toggle key</a>
     <div id="Keytable3">
        <div class="row">
                <span class="heading1">Meaning</span>
                <span class="heading2">Pattern</span>
                <span class="heading3">Result</span>
        </div>
        <div class="row">
            <span class="tripleheight">Show Name</span>
            <span class="pattern">%t</span>
            <span class="result">Show Name</span>
        <br />
            <span class="pattern">%.t</span>
            <span class="result">Show.Name</span>
        <br />
            <span class="pattern">%_t</span>
            <span class="result">Show_Name</span>
        </div>
        <div class="row">
            <span class="doubleheight">Year</span>
            <span class="pattern">%y</span>
            <span class="result">2009</span>
        </div>
        <div class="row">
            <span class="doubleheight">Month</span>
            <span class="pattern">%m</span>
            <span class="result">1</span>
        <br />
            <span class="pattern">%0m</span>
            <span class="result">01</span>
        </div>
        <div class="row">
            <span class="tripleheight">Day of month</span>
            <span class="pattern">%d</span>
            <span class="result">2</span>
        <br />
            <span class="pattern">%0d</span>
            <span class="result">02</span>
        <br />
        </div>
        <div class="row">
            <span class="normalheight">Decade</span>
            <span class="pattern">%decade</span>
            <span class="result">00</span>
        </div>
        <div class="row">
            <span class="normalheight">Lower Case</span>
            <span class="pattern">{TEXT}</span>
            <span class="result">text</span>
        </div>
    </div><br class="clear" />
    <strong>Sort String:</strong><br class="clear" />
    <input type="text" style="width:400px" size="80" id="datefoldername" name="date_sort_string" value="$date_sort_string" onkeyup="javascript:previewdate()"><input type="button" style="width:100px;" onclick="tvClear()" value="Clear"/><br class="clear" />
    <strong>Presets:</strong><br class="clear" />
    <input type="button" onclick="dateSet('%t/%t - %y-%0m-%0d - %desc.%ext')" value="Show Name folder"/>
    <input type="button" onclick="dateSet('%y-%0m/%t - %y-%0m-%0d - %desc.%ext')" value="Year-Month Folders"/>
    <input type="button" onclick="dateSet('%y-%0m-%0d/%t - %y-%0m-%0d - %desc.%ext')" value="Daily Folders"/><br class="clear" />
    <br class="clear" />
    Example: <span id="previewdate"></span>
</fieldset>


</div><br>
<input type="submit" size="40" value="Save Changes">
</form>

<!--#include $webdir + "/inc_bottom.tmpl"#-->
