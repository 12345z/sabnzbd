<%
def displayNotices (action, name):
	if name[1:4] == 'Tim' or name[1:4] == 'Avg':
		return ''
	notice = action[3:11]
	if notice[:-2] != "Joined" and notice != "Verified" and notice[:-1] != "Deleted" and notice != "Unpacked" and notice != "Scanning" and notice != "Repaired" and notice != "Unzipped" and notice != "No par2 ":
		return '<span class="hvMessage">&raquo;&nbsp;' + action[3:] + '&nbsp;</span><br/>'
%>

<a name="HIST"></a>
<table class="queueTable">
<!--#set $cur = 0#-->
<!--#set $odd = False#-->
<!--#if $lines#-->
<!--#for $line in $lines #-->
	<!--#if $limit == 0 or ($limit == -1 and ($line.status=="Failed" or $line.loaded) ) or $cur < $limit#-->
	<!--#set $cur = $cur + 1#-->
	<!--#set $odd = not $odd#-->
	<tr id="$line.nzo" class="<!--#if $odd#-->alt<!--#end if#--> <!--#if $line.loaded #-->active<!--#end if#-->">
	
	<td>
		<div class="historyTitle <!--#if $line.loaded #-->Loaded<!--#else if $line.status=="Failed"#-->Cross<!--#else#-->Check<!--#end if#-->"<!--#if not $line.stages#--> colspan="2"<!--#end if#-->></div>
		<!--#if $line.msgid #-->
		<a href="https://www.newzbin.com/browse/post/$line.msgid/" target="_blank">$line.filename</a>
		<!--#else#-->
		$line.filename
		<!--#end if#-->
	</td>
	
	<!--#if $line.stages#-->
	<td class="last">
		<!--#for $stage in $line.stages#-->
			<!--#for $action in $stage.actions#-->
				<div class="hv_<%=action['name'][1:4]%>" title='<%= action['name'].replace("'","&rsquo;") %><br><%=action['value']%>'>&thinsp;&nbsp;</div><%=displayNotices(action['value'],action['name'])%>
			<!--#end for#-->
		<!--#end for#-->
	</td>
	<!--#end if#-->
	
	<td>
		<div class="queue_delete" title="Hide&nbsp;NZB">&nbsp;&nbsp;&nbsp;&nbsp;</div>
		<small class="history_added">$line.added</small>
	</td>
	
	</tr>
	<!--#end if#-->
<!--#end for#-->
<!--#end if#-->
</table>

<div class="box_fatbottom">
	<div class="right_stats">
		<!--#if $lines#-->
		<strong>$total_bytes&nbsp;GB</strong>&nbsp;In&nbsp;History&nbsp;&nbsp;&nbsp;&nbsp;
		<!--#end if #-->
		<strong>$bytes_beginning&nbsp;GB</strong>&nbsp;Downloaded
	</div>
	<div class="left_stats">
		<small>Showing:</small>&nbsp;<select id="history_view_preference">
			<option value="0"<!--#if $limit==0#--> selected<!--#end if#-->>Everything</option>
			<option value="5"<!--#if $limit==5#--> selected<!--#end if#-->>Latest 5</option>
			<option value="15"<!--#if $limit==15#--> selected<!--#end if#-->>Latest 15</option>
			<option value="25"<!--#if $limit==25#--> selected<!--#end if#-->>Latest 25</option>
			<option value="50"<!--#if $limit==25#--> selected<!--#end if#-->>Latest 50</option>
			<option value="-1"<!--#if $limit==-1#--> selected<!--#end if#-->>Active/Failed Only</option>
		</select>
	</div>
	<div class="history_logo">&nbsp;</div>
</div>
