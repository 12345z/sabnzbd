<% import datetime %>

<script type="text/javascript">
	if (typeof( jQuery ) == 'undefined')
		window.location = "../"; // redirect to main on direct template hit
    
    // set vars within the plush object
    jQuery(function($) {
        $.plush.histnoofslots      = $noofslots;
        $.plush.histstats = "<!--#if $loadavg#--><strong>$loadavg</strong>&nbsp;Load&nbsp;Avg.<!--#end if#--><!--#if $week_size#-->&nbsp;&nbsp;&nbsp;&nbsp;<strong>$week_size</strong>&nbsp;This&nbsp;Week<!--#end if #--><!--#if $month_size#-->&nbsp;&nbsp;&nbsp;&nbsp;<strong>$month_size</strong>&nbsp;This&nbsp;Month<!--#end if #--><!--#if $lines#-->&nbsp;&nbsp;&nbsp;&nbsp;<strong>$total_size</strong>&nbsp;Total<!--#end if #-->";
	});
	
</script>

<a name="HIST"></a>
<table class="queueTable" id="historyTable" cellspacing="0">
<!--#set $cur = 0#-->
<!--#set $odd = False#-->
<!--#if $lines#-->
<!--#for $line in $lines #-->
    <!--#if $limit == 0 or ($limit == -1 and ($line.status=="Failed" or $line.action_line) ) or ($limit == -2 and ($cur < 5 or $line.status=="Failed" or $line.action_line) ) or $cur < $limit#-->
    <!--#set $odd = not $odd#-->
    <tr id="$line.nzo_id" class="<!--#if $odd#-->alt<!--#end if#--> <!--#if $line.action_line #-->active<!--#end if#-->">
    
    <td class="historyTitle <!--#if $line.action_line or $line.status=="Queued"#-->Loaded<!--#else if $line.status=="Failed"#-->Cross<!--#else#-->Check<!--#end if#-->">
        $line.name
    </td>
    
    <td class="verbose">
        <!--#if $line.report #-->
            <a href="https://www.newzbin.com/browse/post/$line.report/" target="_blank">
                <div class="hv_report pointer" title='Open Source URL<br/><br/>https://www.newzbin.com/browse/post/$line.report'>&nbsp;</div>
            </a>
        <!--#else#-->
            <div class="hv_report hvFaded">&nbsp;</div>
        <!--#end if#-->
        <!--#if $line.url_info #-->
            <a href="$line.url_info" target="_blank">
                <div class="hv_url pointer" title="Open Informational URL<br/><br/>$line.url_info">&nbsp;</div>
            </a>
        <!--#else#-->
            <div class="hv_url hvFaded">&nbsp;</div>
        <!--#end if#-->
        <div class="hv_stats" title='<!--#if $line.size#-->Size: $line.size<br/><br/><!--#end if#--><!--#if $line.path#-->Path:<br/><!--#echo $line.path.replace("'","&rsquo;") #--><br/><br/><!--#end if#--><!--#if $line.storage#-->Storage:<br/><!--#echo $line.storage.replace("'","&rsquo;") #--><!--#end if#-->'>&nbsp;</div>
	    <!--#for $stage in $line.stage_log#-->
            <!--#if $stage.name == "script"#-->
                <a href="scriptlog?name=$line.nzo_id">
                    <div class="hv_$stage.name pointer" title='View Script Log<br/><br/><!--#for $action in $stage.actions#--><!--#echo $action.replace("'","&rsquo;") #--><br/><!--#end for#-->'>&nbsp;</div>
                </a>
            <!--#else#-->
                <div class="hv_$stage.name" title='<!--#for $action in $stage.actions#--><!--#echo $action.replace("'","&rsquo;") #--><br/><!--#end for#-->'>&nbsp;</div>
            <!--#end if#-->
        <!--#end for#-->
        <!--#if $line.action_line#-->
        <h3 class="hvMessage">&raquo;&nbsp;$line.action_line&nbsp;</h3>
        <!--#end if#-->
        <!--#if $line.fail_message#-->
        <h3 class="hvMessage">&raquo;&nbsp;$line.fail_message&nbsp;</h3>
        <!--#end if#-->
    </td>
    
    <td class="options" nowrap>
        <!--#if not $line.loaded#-->
        <% d = datetime.datetime.fromtimestamp(float(line['completed'])) %>
        <small class="history_added">$d</small>
        <div class="queue_delete" title="Hide&nbsp;NZB">&nbsp;&nbsp;&nbsp;</div>
        <!--#end if#-->
    </td>
    
    </tr>
    <!--#end if#-->
    <!--#set $cur = $cur + 1#-->
<!--#end for#-->
<!--#end if#-->
</table>
